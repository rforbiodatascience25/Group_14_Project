---
title: "Group_14_Exam"
format: html
editor: visual
---

*This exam project has been conducted by group 14 which includes the students:*

| Name                      | Student number |
|---------------------------|----------------|
| Caroline Sofie Hermannsen | s215016        |
| Helene Nielsen            | s215037        |
| Kathrine Böech Kaas       | s215052        |
| Nadia Hansen              | s215055        |

*All group members contributed equally.*

![](ChatGPT%20Image%2011.%20nov.%202025,%2011.35.39.png){fig-align="center" width="347" height="18"}

DELETE BEFORE SUBMITTING: What we do: See google docs document: <https://docs.google.com/document/d/1yNVCNuAO6bL3kIM9ScEc9Kdcnw6VaJup2c3B_c9R7Nk/edit?usp=sharing>

## Background

Coral reefs around the world are experiencing increased stress due to rising sea-surface temperatures and other climate-driven changes. Coral bleaching is the loss of symbiotic algae from coral tissues, which is often precipitated by thermal stress. It is one of the most visible and damaging consequences of these shifts. The study by Sully et al. 2019 called "A global analysis of coral bleaching over the past two decades," published in Nature, addresses how bleaching patterns have varied globally over recent decades.

The consequences of coral bleaching affect the climate in terms of ecosystem damage due to loss of species and thereby biodiversity, but it also has major social and economic consequences for people who depend on reefs for food and tourism. The species loss can also mean indirect consequences in research e.g., loss of molecules that could have been discovered and used pharmaceutically or elsewhere.

Using field observations collected at 3,351 reef sites across 81 countries between 1998 and 2017, the authors combined these bleaching records with environmental and temperature metrics to identify spatial and temporal patterns \[1\].

In this project we want to perform Data Wrangling and Data Analysis on the datasets from the study. The datasets used are described in Data Description below.

## Data Description

The data used in the can be accessed in the raw –\> data file in the Github project "Group_14_Project". The original data has been downloaded from <https://github.com/InstituteForGlobalEcology/Coral-bleaching-a-global-analysis-of-the-past-two-decades>. The specific file "Reef_Check_with_cortad_variables_with_annual_rate_of_SST_change.csv" has been the data file providing the information used for all the findings of the project. Please note that this file was already fairly tidy, and for this reason it has been untidied and split into two datasets called "reef_data_dataset1.csv" and "reef_data_dataset2.csv". This provided a better opportunity for the group to show an understanding of more functions.

The data contains many variables with names that include abbreviations. In the following list, the important ones to understand are explained:

-   SST(A): Sea Surface Temperature (Anomaly)

    -   The SST is the measured sea surface temperature in degrees Celsius for the given observation. SSTA is the degree Celsius difference compared to the normal temperature at that site (typically based on a week or month). The temperatures were derived from the *Coral Reef Temperature Anomaly Database* by the article authors.

-   TSA: Thermal Stress Anomaly

    -   TSA is the SST but with the SST maximum of a historical period subtracted. This means that the TSA is also given in degrees, and it only becomes positive if the measured SST was above the hottest week in the included climatology.

-   DHW: Degree Heating Weeks

    -   DHW is describing the cumulative thermal stress over a longer period. If DHW = 1, it means that a site was 1 degree Celsius above the warmest month at the site within long-term climatology. DHW is based on anomalies for a longer period (cumulative), whereas the SSTA and TSA are more like "snapshots" based on the anomaly at the time for the measurement.

## Aim

The aim of this project has been to tidy and combine two datasets and by doing this, be able to explore coral bleaching issues around the world. This is a collaborative project developed using Git and the workflow is also a part of the product.

## Load Libraries

```{r}
#| message: false
library("tidyverse")
```

## Load Data

The two different datasets are here loaded into the document and saved as data1 and data2. When viewing the two files, we see that they both contain ReefID_Name as the first column. This column is untidy since we have two different informations in one cell.

```{r}
#| message: false
data1 <- read_csv(file="data/_raw/reef_data_dataset1.csv")
data2 <- read_csv(file="data/_raw/reef_data_dataset2.csv")

View(data1)
View(data2)
```

## Data Wrangling

Starting out with the data wrangling we want to first combine the two datasets using the join function and combining them by their common column.

```{r}
#| message: false
reef_combined_untidy <- data1 |>
  left_join(data2, by = "ReefID_Name")

write_csv(reef_combined_untidy, "data/_raw/reef_data_combined_untidy.csv")
```

Now we want to tidy the dataset, and turn ReefID_Name into two separate variables. For this we use the seperate function and split them by "\|".

```{r}
reef_combined_tidy <- reef_combined_untidy |>
  separate(
    col  = "ReefID_Name",
    into = c("Reef.ID", "Reef.Name"),
    sep  = " \\| "
  ) |>
  relocate(Reef.ID, Reef.Name, .before = 1)

View(reef_combined_tidy)

write_csv(reef_combined_tidy, "data/_raw/reef_data_combined_tidy.csv")
```

We want to check if the variable Ocean has any NA values. For this we can use the function count.

```{r}
reef_combined_tidy |>
  count(Ocean)
```

We want to remove all the observations where Ocean has NA values and we can see that 57 observations has NA values. For this we can use drop_na to remove them from the dataset.

```{r}
reef_clean <-
  reef_combined_tidy |>
  drop_na(Ocean)
```

## Data Analysis

We want to check how many observations we have for each year.

```{r}
reef_clean |>
  count(Year)
```

We see that three years (1998, 2000 and 2001) does not contain many observations so these we want to filter out.

```{r}
reef_clean <- reef_clean |>
  filter(Year != 1998,
         Year != 2000,
         Year != 2001)
```

We make a plot based on the different seas to see if any datapoints stands out.

```{r}
ggplot(data = reef_clean,
       mapping = aes(x = Year,
                     y = Average_bleaching)) +
  geom_point(alpha = (2)) +
  labs(x="Year", y="Average_bleaching", title="T10 Scatterplot", fill="Ocean", color="Ocean") +
  facet_wrap(~ Ocean)
```

From the above, we see that the East Pacific only has few data points. We count them:

```{r}
reef_clean |> 
  count(Ocean)
```

We conclude that, based on six rows, the East pacific has too few data points for further analysis when comparing to the other seas. Hence, we filter it out.

```{r}
reef_clean <- reef_clean |>
  filter(Ocean != "East Pacific")
```

We want to add another column with the temperatures in degrees Celsius using mutate.

```{r}
reef_clean <- reef_clean |>
  mutate(Temperature_Celsius = Temperature_Kelvin - 273.15)
```

We now investigate the temperature development over time.

```{r}
ggplot(data = reef_clean,
       mapping = aes(x = Year,
                     y = Temperature_Celsius)) +
  geom_point(alpha = (2)) +
  labs(x = "Year", y = "Temperature_Celsius", title = "T10 Scatterplot", fill="Ocean", color="Ocean") +
  facet_wrap(~ Ocean)
```

In the Red Sea and the Arabian Gulf, the temperature has decreased in the included time period, whereas in the temperature in the Pacific, Atlantic and Indian Sea has increased. It is important to highlight that this only reflects the temperature where the samples were taken and not nessercerily the overall climate tendency.

We here investigate the latitude and temperature connection.

```{r}
ggplot(data = reef_clean,
       mapping = aes(x = Latitude.Degrees,
                     y = Temperature_Celsius)) +
  geom_point(alpha = (2)) +
  labs(x = "Latidtude.Degrees", y = "Temperature_Celsius", title = "T10 Scatterplot", fill = "Ocean", color = "Ocean") +
  facet_wrap(~ Ocean)
```

The possitive latitudes are north from equator and the negative are south. The data points from the Pacific, Atlantic, and Indian oceans cover both equator, north and south, with the pacific ocean having a more even spread of data points covering the latitude range.

We note that there is a great variation in the measured temperatures at the same latitudes. We investigate the depths of the sampling affect on the temperature:

```{r}
ggplot(data = reef_clean,
       mapping = aes(x = Temperature_Celsius,
                     y = Depth)) +
  geom_point(alpha = (2)) +
  labs(x = "Temperature_Celsius", y = "Depth", title = "T10 Scatterplot", fill = "Ocean", color = "Ocean") +
  facet_wrap(~ Ocean)

```

#### Zooming in on the Pacific Ocean

Due to the Pacific Ocean having a lot of data points distributed along the latitudes, we go further with the bleaching analysis in this ocean.

We combine ggplot in a pipeline to only see Pacific Ocean data with latitudes and average bleaching.

```{r}
reef_clean |> 
  select(Ocean = Pacific) |> 
  ggplot(data = reef_clean,
       mapping = aes(x = Latitude.Degrees,
                     y = Average_bleaching)) +
  geom_point(alpha = (2)) +
  labs(x = "Latitude.Degrees", y = "Average_bleaching", title = "T10 Scatterplot", fill = "Ocean", color = "Ocean")
```

The average bleaching seems higher for latitudes from -5 and further south and +5 and further north.

The hypothesis: READ IN ARTICLE, something about species diversity

Lastly we investigate the average bleaching over the years for the Pacific Ocean, trying to replicate figure 3.

```{r}
reef_clean |> 
  select(Ocean = Pacific) |> 
  ggplot(data = reef_clean,
       mapping = aes(x = factor(Year),
                     y = Average_bleaching)) +
  geom_boxplot(alpha = (2)) +
  labs(x = "Year", y = "Average_bleaching", title = "Boxplot")
```

## Conclusion

Coral bleaching is a global issue...

## References

\[1\] Sully, S., Burkepile, D.E., Donovan, M.K. *et al.* A global analysis of coral bleaching over the past two decades. *Nat Commun* **10**, 1264 (2019). https://doi.org/10.1038/s41467-019-09238-2
